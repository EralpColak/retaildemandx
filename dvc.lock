schema: '2.0'
stages:
  ingest_synth:
    cmd: python -m src.data.ingest_synthetic --out_dir data/raw --start 
      2024-01-01 --end 2024-03-31 --n_stores 8 --n_skus 5
    outs:
    - path: data/raw/sales.parquet
      hash: md5
      md5: b27dbd51e92386bc33177f031884db9b
      size: 175293
  validate:
    cmd: python -m src.data.validate
    deps:
    - path: data/raw/sales.parquet
      hash: md5
      md5: 5c0ec17cef678b61865036d5ca1b85ef
      size: 174072
    - path: src/data/validate.py
      hash: md5
      md5: 56aa315ca8ba25c18daccfdda4ddd521
      size: 1223
  features:
    cmd: python -m src.features.build_features
    deps:
    - path: data/raw/sales.parquet
      hash: md5
      md5: b27dbd51e92386bc33177f031884db9b
      size: 175293
    - path: src/features/build_features.py
      hash: md5
      md5: ff671166fc5b0ccd51c8dae87745df53
      size: 1743
    outs:
    - path: data/processed/features.parquet
      hash: md5
      md5: e14e65b547cd607ec10e5c852c8f9b1e
      size: 1964229
  train:
    cmd: python -m src.models.train
    deps:
    - path: data/processed/features.parquet
      hash: md5
      md5: f6893d06fc73797904321d000411476f
      size: 1961118
    - path: src/models/train.py
      hash: md5
      md5: f20ffa0eb55283407b3796d3ed522672
      size: 6340
    outs:
    - path: artifacts/metrics.json
      hash: md5
      md5: be5ce30ac47688fe946705b2ac8efe70
      size: 125
    - path: artifacts/models
      hash: md5
      md5: 62b2710a568cabc285432da45f33d53e.dir
      size: 42851277
      nfiles: 48
  evaluate:
    cmd: python -m src.models.evaluate
    deps:
    - path: artifacts/models
      hash: md5
      md5: 62b2710a568cabc285432da45f33d53e.dir
      size: 42851277
      nfiles: 48
    - path: src/models/evaluate.py
      hash: md5
      md5: 9a8f7e7dfb4d0fa521eec3120553bea8
      size: 4874
    outs:
    - path: artifacts/reports
      hash: md5
      md5: c58c0b291d5a67b4a8afad517fa501ff.dir
      size: 507169
      nfiles: 5
  register:
    cmd: python -m src.models.register
    deps:
    - path: artifacts/models
      hash: md5
      md5: 62b2710a568cabc285432da45f33d53e.dir
      size: 42851277
      nfiles: 48
    - path: artifacts/reports/summary.json
      hash: md5
      md5: be5ce30ac47688fe946705b2ac8efe70
      size: 125
    - path: src/models/register.py
      hash: md5
      md5: 890358bb96b74957b83f0d94d64c59ed
      size: 2767
    outs:
    - path: artifacts/registry
      hash: md5
      md5: f504e5163d5c24750d182b60c91119f6.dir
      size: 42854086
      nfiles: 49
  forecast_batch:
    cmd: python -m src.pipelines.batch_forecast --horizons 24 --out_dir 
      artifacts/forecasts
    deps:
    - path: artifacts/registry/staging/current
      hash: md5
      md5: c8fd6d6c11e3e55d0e4b39c3eadda296.dir
      size: 42854086
      nfiles: 49
    - path: data/processed/features.parquet
      hash: md5
      md5: f6893d06fc73797904321d000411476f
      size: 1961118
    - path: src/pipelines/batch_forecast.py
      hash: md5
      md5: 2a48d9c1ca2e08b56b6680bf94efc795
      size: 3729
    outs:
    - path: artifacts/forecasts
      hash: md5
      md5: 6dec429f5f0c8ac0e31b0faa9000f9ec.dir
      size: 57593
      nfiles: 3
